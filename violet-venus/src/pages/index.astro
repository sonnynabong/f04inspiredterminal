---
import TerminalLayout from '../layouts/TerminalLayout.astro';
import CRTEffects from '../components/CRTEffects.astro';
import BootScreen from '../components/BootScreen.astro';
import TerminalHeader from '../components/TerminalHeader.astro';
import MainMenu from '../components/MainMenu.astro';
import HomeContent from '../components/HomeContent.astro';
import ProjectArchives from '../components/ProjectArchives.astro';
import SkillsDb from '../components/SkillsDb.astro';
import AboutUser from '../components/AboutUser.astro';
import CommsLink from '../components/CommsLink.astro';
import TerminalFooter from '../components/TerminalFooter.astro';
---

<TerminalLayout title="RobCo Termlink - Fallout 4 Terminal">
  <div class="relative w-full h-screen overflow-hidden">
    <!-- CRT Effects (always on) -->
    <CRTEffects showScanlineBar={true} intensity="medium" />

    <!-- CRT flash overlay for transitions (controlled by JS) -->
    <div id="crt-flash-overlay" class="fixed inset-0 z-[100] pointer-events-none opacity-0" aria-hidden="true"></div>

    <!-- Boot Screen -->
    <div id="boot-view" class="fixed inset-0 z-20 flex flex-col" style="display: flex;">
      <BootScreen onEnter="enter-terminal" />
    </div>

    <!-- Home / Main Terminal -->
    <div id="home-view" class="fixed inset-0 z-20 flex flex-col" style="display: none;">
      <div class="relative z-10 flex flex-col h-screen w-full p-4 md:p-8 max-w-[1600px] mx-auto">
        <header class="flex flex-col md:flex-row items-start md:items-center justify-between border-b-2 border-[#13ec13]/40 pb-4 mb-6 gap-4">
          <div class="flex items-center gap-3">
            <span class="material-symbols-outlined text-4xl animate-pulse text-glow">terminal</span>
            <div>
              <h1 class="text-xl md:text-2xl font-bold tracking-widest text-glow">ROBCO INDUSTRIES (TM)</h1>
              <p class="text-xs tracking-[0.2em] opacity-80">UNIFIED OPERATING SYSTEM // TERMLINK PROTOCOL</p>
            </div>
          </div>
          <div class="flex items-center gap-4 text-sm font-bold tracking-widest">
            <div class="hidden md:flex flex-col items-end">
              <span class="text-xs opacity-60">COPYRIGHT 2077</span>
              <span>CLEARANCE: ADMINISTRATOR</span>
            </div>
            <div class="h-8 w-[2px] bg-[#13ec13]/40 hidden md:block"></div>
            <button type="button" id="logout-btn" class="group flex items-center gap-2 hover:bg-[#13ec13] hover:text-[#020502] px-3 py-1 transition-colors border border-transparent hover:border-[#13ec13] rounded">
              <span>LOGOUT</span>
              <span class="material-symbols-outlined text-sm">logout</span>
            </button>
          </div>
        </header>
        <div class="flex-1 flex flex-col lg:flex-row gap-6 overflow-hidden min-h-0">
          <aside class="w-full lg:w-1/4 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden shrink-0 min-h-0">
            <MainMenu activeItem="" embedded={true} />
          </aside>
          <section class="flex-1 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden min-h-0">
            <HomeContent />
          </section>
        </div>
        <div class="mt-4 py-2 px-4 flex items-center border border-[#13ec13]/30 rounded bg-[#020502]/50 font-mono text-sm">
          <span class="mr-2 font-bold text-[#13ec13] shrink-0">ADMIN@TERMINAL:~$</span>
          <input type="text" id="terminal-input" autocomplete="off" class="bg-transparent border-none text-[#13ec13] focus:ring-0 p-0 w-full font-mono placeholder-[#13ec13]/50 uppercase min-w-0" placeholder="ENTER COMMAND..." />
          <span class="w-3 h-5 bg-[#13ec13] ml-1 cursor-blink inline-block shrink-0" aria-hidden="true"></span>
        </div>
        <footer class="mt-4 pt-4 border-t border-[#13ec13]/30 flex flex-wrap justify-between items-center text-xs md:text-sm font-bold tracking-widest uppercase gap-4">
          <div class="flex gap-6">
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[TAB]</span> NEXT</span>
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ENTER]</span> EXECUTE</span>
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ESC]</span> BACK</span>
          </div>
          <div class="flex items-center gap-2 opacity-60">
            <span class="w-2 h-2 rounded-full bg-[#13ec13] animate-pulse"></span>
            SYSTEM ONLINE
          </div>
        </footer>
      </div>
    </div>

    <!-- Project Archives Subpage -->
    <div id="archives-view" class="fixed inset-0 z-20 flex flex-col" style="display: none;">
      <div class="relative z-10 flex flex-col h-screen w-full p-4 md:p-8 max-w-[1600px] mx-auto">
        <header class="flex flex-col md:flex-row items-start md:items-center justify-between border-b-2 border-[#13ec13]/40 pb-4 mb-6 gap-4">
          <div class="flex items-center gap-3">
            <span class="material-symbols-outlined text-4xl animate-pulse text-glow">terminal</span>
            <div>
              <h1 class="text-xl md:text-2xl font-bold tracking-widest text-glow">ROBCO INDUSTRIES (TM)</h1>
              <p class="text-xs tracking-[0.2em] opacity-80">TERMLINK PROTOCOL // UNIFIED OPERATING SYSTEM</p>
            </div>
          </div>
          <div class="flex items-center gap-4 text-sm font-bold tracking-widest">
            <div class="hidden md:flex flex-col items-end">
              <span class="text-xs opacity-60">USER_ID</span>
              <span>ADMIN_OVERRIDE</span>
            </div>
            <div class="h-8 w-[2px] bg-[#13ec13]/40 hidden md:block"></div>
            <button
              type="button"
              id="archives-back-btn"
              class="group flex items-center gap-2 hover:bg-[#13ec13] hover:text-[#020502] px-3 py-1 transition-colors border border-transparent hover:border-[#13ec13] rounded"
            >
              <span>BACK</span>
              <span class="material-symbols-outlined text-sm">arrow_back</span>
            </button>
          </div>
        </header>
        <ProjectArchives />
        <footer class="mt-6 pt-4 border-t border-[#13ec13]/30 flex flex-wrap justify-between items-center text-xs md:text-sm font-bold tracking-widest uppercase gap-4">
          <div class="flex gap-6">
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[TAB]</span> NEXT ENTRY</span>
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ENTER]</span> EXECUTE</span>
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ESC]</span> BACK</span>
          </div>
          <div class="flex items-center gap-2 opacity-60">
            <span class="w-2 h-2 rounded-full bg-[#13ec13] animate-pulse"></span>
            SYSTEM ONLINE
          </div>
        </footer>
      </div>
    </div>

    <!-- Skills DB Page -->
    <div id="skills-view" class="fixed inset-0 z-20 flex flex-col" style="display: none;">
      <div class="relative z-10 flex flex-col h-screen w-full p-4 md:p-8 max-w-[1600px] mx-auto">
        <header class="flex flex-col md:flex-row items-start md:items-center justify-between border-b-2 border-[#13ec13]/40 pb-4 mb-6 gap-4">
          <div class="flex items-center gap-3">
            <span class="material-symbols-outlined text-4xl animate-pulse text-glow">terminal</span>
            <div>
              <h1 class="text-xl md:text-2xl font-bold tracking-widest text-glow">ROBCO INDUSTRIES (TM)</h1>
              <p class="text-xs tracking-[0.2em] opacity-80">UNIFIED OPERATING SYSTEM // TERMLINK PROTOCOL</p>
            </div>
          </div>
          <button type="button" id="skills-back-btn" class="group flex items-center gap-2 hover:bg-[#13ec13] hover:text-[#020502] px-3 py-1 transition-colors border border-transparent hover:border-[#13ec13] rounded text-sm font-bold">
            <span class="material-symbols-outlined text-sm">arrow_back</span> BACK
          </button>
        </header>
        <div class="flex-1 flex flex-col lg:flex-row gap-6 overflow-hidden min-h-0">
          <aside class="w-full lg:w-1/4 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden shrink-0 min-h-0">
            <MainMenu activeItem="skills" embedded={true} />
          </aside>
          <section class="flex-1 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden min-h-0">
            <SkillsDb />
          </section>
        </div>
        <footer class="mt-6 pt-4 border-t border-[#13ec13]/30 flex flex-wrap justify-between items-center text-xs md:text-sm font-bold tracking-widest uppercase gap-4">
          <div class="flex gap-6">
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ESC]</span> BACK</span>
          </div>
          <div class="flex items-center gap-2 opacity-60">
            <span class="w-2 h-2 rounded-full bg-[#13ec13] animate-pulse"></span>
            SYSTEM ONLINE
          </div>
        </footer>
      </div>
    </div>

    <!-- About User Page -->
    <div id="about-view" class="fixed inset-0 z-20 flex flex-col" style="display: none;">
      <div class="relative z-10 flex flex-col h-screen w-full p-4 md:p-8 max-w-[1600px] mx-auto">
        <header class="flex flex-col md:flex-row items-start md:items-center justify-between border-b-2 border-[#13ec13]/40 pb-4 mb-6 gap-4">
          <div class="flex items-center gap-3">
            <span class="material-symbols-outlined text-4xl animate-pulse text-glow">terminal</span>
            <div>
              <h1 class="text-xl md:text-2xl font-bold tracking-widest text-glow">ROBCO INDUSTRIES (TM)</h1>
              <p class="text-xs tracking-[0.2em] opacity-80">UNIFIED OPERATING SYSTEM // TERMLINK PROTOCOL</p>
            </div>
          </div>
          <button type="button" id="about-back-btn" class="group flex items-center gap-2 hover:bg-[#13ec13] hover:text-[#020502] px-3 py-1 transition-colors border border-transparent hover:border-[#13ec13] rounded text-sm font-bold">
            <span class="material-symbols-outlined text-sm">arrow_back</span> BACK
          </button>
        </header>
        <div class="flex-1 flex flex-col lg:flex-row gap-6 overflow-hidden min-h-0">
          <aside class="w-full lg:w-1/4 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden shrink-0 min-h-0">
            <MainMenu activeItem="about" embedded={true} />
          </aside>
          <section class="flex-1 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden min-h-0">
            <AboutUser />
          </section>
        </div>
        <footer class="mt-6 pt-4 border-t border-[#13ec13]/30 flex flex-wrap justify-between items-center text-xs md:text-sm font-bold tracking-widest uppercase gap-4">
          <div class="flex gap-6">
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ESC]</span> BACK</span>
          </div>
          <div class="flex items-center gap-2 opacity-60">
            <span class="w-2 h-2 rounded-full bg-[#13ec13] animate-pulse"></span>
            SYSTEM ONLINE
          </div>
        </footer>
      </div>
    </div>

    <!-- Comms Link Page -->
    <div id="comms-view" class="fixed inset-0 z-20 flex flex-col" style="display: none;">
      <div class="relative z-10 flex flex-col h-screen w-full p-4 md:p-8 max-w-[1600px] mx-auto">
        <header class="flex flex-col md:flex-row items-start md:items-center justify-between border-b-2 border-[#13ec13]/40 pb-4 mb-6 gap-4">
          <div class="flex items-center gap-3">
            <span class="material-symbols-outlined text-4xl animate-pulse text-glow">terminal</span>
            <div>
              <h1 class="text-xl md:text-2xl font-bold tracking-widest text-glow">ROBCO INDUSTRIES (TM)</h1>
              <p class="text-xs tracking-[0.2em] opacity-80">UNIFIED OPERATING SYSTEM // TERMLINK PROTOCOL</p>
            </div>
          </div>
          <button type="button" id="comms-back-btn" class="group flex items-center gap-2 hover:bg-[#13ec13] hover:text-[#020502] px-3 py-1 transition-colors border border-transparent hover:border-[#13ec13] rounded text-sm font-bold">
            <span class="material-symbols-outlined text-sm">arrow_back</span> BACK
          </button>
        </header>
        <div class="flex-1 flex flex-col lg:flex-row gap-6 overflow-hidden min-h-0">
          <aside class="w-full lg:w-1/4 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden shrink-0 min-h-0">
            <MainMenu activeItem="comms" embedded={true} />
          </aside>
          <section class="flex-1 flex flex-col border-2 border-[#13ec13]/30 bg-[#020502]/50 backdrop-blur-sm rounded-lg overflow-hidden min-h-0">
            <CommsLink />
          </section>
        </div>
        <footer class="mt-6 pt-4 border-t border-[#13ec13]/30 flex flex-wrap justify-between items-center text-xs md:text-sm font-bold tracking-widest uppercase gap-4">
          <div class="flex gap-6">
            <span class="flex items-center gap-1 opacity-70"><span class="bg-[#13ec13]/20 px-1 rounded">[ESC]</span> BACK</span>
          </div>
          <div class="flex items-center gap-2 opacity-60">
            <span class="w-2 h-2 rounded-full bg-[#13ec13] animate-pulse"></span>
            SYSTEM ONLINE
          </div>
        </footer>
      </div>
    </div>
  </div>

  <script>
    import '../scripts/terminal';
  </script>
</TerminalLayout>
